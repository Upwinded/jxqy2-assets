		If( $CAFight == 1) Goto @Label1;
		If( $CAFight == 2) Goto @Label2;
		DisableNpcAI();
		PlayerGoto(150,208);
		PlayerGoto(152,192);
		SetPlayerDir(6);
		DelNpc("旁观者");
		Talk("ShangGuanB");
		MoveScreen(6,200);
		Talk("ShangGuanB1");
		Sleep(1000);
		SetNpcDir("陈三",2);
		Talk("ShangGuanB2");
		SetNpcDir("上官豹",2);
		SetNpcDir("知府",2);
		MoveScreen(2,200);
		Talk("ShangGuanB3");
		NpcGotoEx("枪手1",153,190);
		NpcGotoEx("枪手2",153,193);
		NpcGotoEx("枪手3",152,195);
		NpcGoto("枪手4",151,194);

		SetNpcDir("知府",3);
		Talk("ShangGuanB4");

		NpcGoto("枪手5",155,187);
		SetNpcDir("枪手5",7);
		NpcGotoEx("枪手1",155,193);
		NpcGotoEx("枪手2",156,194);
		NpcGotoEx("枪手3",157,196);
		NpcGotoEx("枪手4",157,197);
		PlayerGoto(158,190);
		SetPlayerDir(7);
		SetNpcDir("枪手1",5);
		SetNpcDir("枪手2",5);
		SetNpcDir("枪手3",5);
		SetNpcDir("枪手4",5);
		SetNpcDir("上官豹",2);
		SetNpcDir("陈三",2);	
		SetNpcDir("知府",3);
		Talk("ShangGuanB5");
		SetNpcDir("知府",5);
		PlayerGoto(159,188);
		SetPlayerDir(6);
		SetNpcDir("上官豹",2);
		Talk("ShangGuanB6");
		PlayerGoto(159,187);
		SetPlayerDir(7);
		SetNpcDir("上官豹",3);	
		SetNpcDir("陈三",3);
		Talk("ShangGuanB7");
		PlayerGoto(159,188);
		SetNpcDir("上官豹",2);	
		SetNpcDir("陈三",2);
		SetPlayerDir(0);
		Talk("ShangGuanB8");
		PlayerGoto(158,190);
		SetPlayerDir(7);
		SetNpcDir("上官豹",1);	
		SetNpcDir("知府",3);
		SetNpcDir("陈三",1);
		Talk("ShangGuanB9");
		PlayerGoto(158,186);
		SetPlayerDir(7);
		SetNpcDir("陈三",3);		
		SetNpcDir("上官豹",3);
		Talk("ShangGuanB10");
		NpcGotoEx("上官豹",162,181);
		NpcGoto("知府",155,197);
		SetNpcDir("上官豹",1);
		SetNpcDir("知府",5);
		SetNpcRelation("官兵",0);
		SetNpcRelation("枪手1",0);
		SetNpcRelation("枪手2",0);
		SetNpcRelation("枪手3",0);
		SetNpcRelation("枪手4",0);
		SetNpcRelation("枪手5",0);
		Assign($CAFight,1);
		SetMapTrap(7,"MapTrap7.txt");
		EnableNpcAI();
		Return;
@Label1:
		FadeOut();
		SetPlayerPos(147,213);
		SetPlayerDir(5);
		SetMapTrap(7,"MapTrap7.txt");
		FadeIn();
		DisableNpcAI();
		Talk("ShangGuanB15");
		EnableNpcAI();
		Return;
//战斗结束
@Label2:
		FadeOut();
		DelNpc("知府");
		ClearBody();
		FadeIn();
		SetNpcActionType("旁观者",1);
		SetNpcPos("上官豹",169,162);
		SetNpcScript("旁观者","");
		Talk("ShangGuanB16");
		SaveMapTrap();
		Return;
